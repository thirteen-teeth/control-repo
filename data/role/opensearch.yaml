---

opensearch::version: '1.1.0'
opensearch::config_hash:
  discovery.seed_hosts: ['os-master-01.puppetdomain', 'os-master-02.puppetdomain', 'os-master-03.puppetdomain']
  cluster.initial_master_nodes: ['os-master-01.puppetdomain', 'os-master-02.puppetdomain', 'os-master-03.puppetdomain']
  cluster.name: 'vagrant'

consul_template::templates:
  cert:
    source: '/tmp/cert.tpl'
    destination: "/opt/opensearch-%{lookup('opensearch::version')}/config/cert.pem"
  private:
    source: '/tmp/private.tpl'
    destination: "/opt/opensearch-%{lookup('opensearch::version')}/config/private.pem"
  ca:
    source: '/tmp/ca.tpl'
    destination: "/opt/opensearch-%{lookup('opensearch::version')}/config/ca.pem"
  riker:
    source: '/tmp/riker.tpl'
    destination: "/opt/opensearch-%{lookup('opensearch::version')}/config/riker.pem"
  riker_private:
    source: '/tmp/riker_private.tpl'
    destination: "/opt/opensearch-%{lookup('opensearch::version')}/config/riker_private.pem"

consul::services:
  opensearch_master:
    address: '%{facts.fqdn}'
    port: 9200
    checks:
      - tcp: 'localhost:9200'
        interval: '1m'
        timeout: '10s'