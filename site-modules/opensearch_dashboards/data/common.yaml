---
opensearch_dashboards::version: '1.1.0'
opensearch_dashboards::ensure: 'present'
opensearch_dashboards::artifact_base_url: 'https://artifacts.opensearch.org/releases/bundle/opensearch-dashboards'
opensearch_dashboards::artifact_name: "opensearch-%{lookup('opensearch_dashboards::version')}-linux-x64.tar.gz"
opensearch_dashboards::artifact_full_url: "%{lookup('opensearch_dashboards::artifact_base_url')}/%{lookup('opensearch_dashboards::version')}/opensearch-dashboards-%{lookup('opensearch_dashboards::version')}-linux-x64.tar.gz"
opensearch_dashboards::download_target_dir: '/opt'
opensearch_dashboards::extract_dir: '/opt'
opensearch_dashboards::install_dir: "%{lookup('opensearch_dashboards::extract_dir')}/opensearch-dashboards-%{lookup('opensearch_dashboards::version')}"
opensearch_dashboards::manage_user: true
opensearch_dashboards::manage_systemd: true
opensearch_dashboards::username: 'opensearch-dashboards'
opensearch_dashboards::config_dir: "%{lookup('opensearch_dashboards::install_dir')}/config"
opensearch_dashboards::log_dir: '/var/log/opensearch-dashboards'
opensearch_dashboards::data_dir: '/var/lib/opensearch-dashboards'
opensearch_dashboards::config_hash:
  server.host: 0.0.0.0
  opensearchDashboards.index: ".opensearch_dashboards"
  opensearch.ssl.verificationMode: none   # FIX ME, more below
  opensearch.username: "kibanaserver"
  opensearch.password: "kibanaserver"
  opensearch.requestHeadersWhitelist: [ authorization,securitytenant ]
  server.ssl.enabled: true
  server.ssl.certificate: '/opt/opensearch-dashboards-%{lookup('opensearch_dashboards::version')}/config/cert.pem'
  server.ssl.key: '/opt/opensearch-dashboards-%{lookup('opensearch_dashboards::version')}/config/private.pem'
  # as per https://opensearch.org/docs/latest/dashboards/install/tls/
  # opensearch dashboards requires the intermediate and root ca or verificationMode: none
  # its not obvious how to create a consul-template for the root ca cert without
  # issuing every kibana host a key in that root ca chain which is not ideal
  opensearch.ssl.certificateAuthorities: [ "/opt/opensearch-dashboards-%{lookup('opensearch_dashboards::version')}/config/ca.pem" ]
  opensearch_security.multitenancy.enabled: true
  opensearch_security.multitenancy.tenants.preferred: ["Private", "Global"]
  opensearch_security.readonly_mode.roles: ["kibana_read_only"]
  opensearch_security.cookie.secure: true